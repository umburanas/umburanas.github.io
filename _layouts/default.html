<!DOCTYPE html>
<html lang="{{ page.lang | default: site.lang | default: " en" }}">

{%- include head.html -%}

<body>

    <div class="site-container">
        <!-- Sidebar Navigation -->
        <nav class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a class="sidebar-title" href="{{ " /" | relative_url }}">
                    {{ site.title | escape }}
                </a>
                <button class="sidebar-toggle" id="sidebar-toggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>

            <div class="sidebar-content">
                <ul class="sidebar-nav">
                    {%- assign default_paths = site.pages | map: "path" -%}
                    {%- assign page_paths = site.header_pages | default: default_paths -%}
                    {%- for path in page_paths -%}
                    {%- assign my_page = site.pages | where: "path", path | first -%}
                    {%- if my_page.title -%}
                    {%- assign nav_title = site.navigation[path] | default: my_page.title -%}
                    <li class="sidebar-nav-item">
                        <a class="sidebar-nav-link {% if page.url == my_page.url %}active{% endif %}"
                            href="{{ my_page.url | relative_url }}">
                            {{ nav_title | escape }}
                        </a>
                    </li>
                    {%- endif -%}
                    {%- endfor -%}
                </ul>

                <div class="sidebar-footer">
                    {%- include language-selector.html -%}
                </div>
            </div>
        </nav>

        <!-- Main Content Area -->
        <div class="main-content" id="main-content">
            <!-- Mobile Header (only visible on mobile) -->
            <header class="mobile-header">
                <button class="mobile-menu-btn" id="mobile-menu-btn">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
                <a class="mobile-title" href="{{ " /" | relative_url }}">
                    {{ site.title | escape }}
                </a>
            </header>

            <!-- Page Content -->
            <main class="page-content" aria-label="Content">
                <div class="wrapper">
                    {{ content }}
                </div>
            </main>

            {%- include footer.html -%}
        </div>
    </div>

    <!-- Overlay for mobile -->
    <div class="sidebar-overlay" id="sidebar-overlay"></div>

    <script>
        // Sidebar toggle functionality
        document.addEventListener('DOMContentLoaded', function () {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebar-overlay');
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            const sidebarToggle = document.getElementById('sidebar-toggle');

            function toggleSidebar() {
                sidebar.classList.toggle('active');
                overlay.classList.toggle('active');
                document.body.classList.toggle('sidebar-open');
            }

            function closeSidebar() {
                sidebar.classList.remove('active');
                overlay.classList.remove('active');
                document.body.classList.remove('sidebar-open');
            }

            // Mobile menu button
            if (mobileMenuBtn) {
                mobileMenuBtn.addEventListener('click', toggleSidebar);
            }

            // Sidebar toggle button
            if (sidebarToggle) {
                sidebarToggle.addEventListener('click', toggleSidebar);
            }

            // Overlay click to close
            if (overlay) {
                overlay.addEventListener('click', closeSidebar);
            }

            // Close sidebar when clicking on main content on mobile
            document.getElementById('main-content').addEventListener('click', function () {
                if (window.innerWidth <= 768 && sidebar.classList.contains('active')) {
                    closeSidebar();
                }
            });

            // Handle window resize
            window.addEventListener('resize', function () {
                if (window.innerWidth > 768) {
                    closeSidebar();
                }
            });
        });
    </script>

</body>

</html>