<div class="language-selector">
    <button class="flag-btn" data-lang="pt" title="Português">🇧🇷</button>
    <button class="flag-btn" data-lang="es" title="Español">🇪🇸</button>
    <button class="flag-btn" data-lang="en" title="English">🇬🇧</button>
    <button class="flag-btn" data-lang="de" title="Deutsch">🇩🇪</button>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Get current language from localStorage or default to 'pt'
        let currentLanguage = localStorage.getItem('selectedLanguage') || 'pt';

        // Update active flag button
        updateActiveFlag(currentLanguage);

        // Handle flag button clicks
        document.querySelectorAll('.flag-btn').forEach(btn => {
            btn.addEventListener('click', function (e) {
                e.preventDefault();
                const lang = this.dataset.lang;

                // Update current language
                currentLanguage = lang;
                localStorage.setItem('selectedLanguage', lang);
                updateActiveFlag(lang);

                // Translate page
                translatePage(lang);
            });
        });

        function updateActiveFlag(lang) {
            // Remove active class from all buttons
            document.querySelectorAll('.flag-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            // Add active class to current language button
            const activeBtn = document.querySelector(`[data-lang="${lang}"]`);
            if (activeBtn) {
                activeBtn.classList.add('active');
            }
        }

        function translatePage(lang) {
            const translations = {
                pt: {
                    'História': 'História',
                    'Evolução': 'Evolução',
                    'Consórcios': 'Consórcios',
                    'Recursos': 'Recursos',
                    'Sobre': 'Sobre',
                    'Contato': 'Contato'
                },
                es: {
                    'História': 'Historia',
                    'Evolução': 'Evolución',
                    'Consórcios': 'Consorcios',
                    'Recursos': 'Recursos',
                    'Sobre': 'Acerca de',
                    'Contato': 'Contacto'
                },
                en: {
                    'História': 'History',
                    'Evolução': 'Evolution',
                    'Consórcios': 'Consortiums',
                    'Recursos': 'Resources',
                    'Sobre': 'About',
                    'Contato': 'Contact'
                },
                de: {
                    'História': 'Geschichte',
                    'Evolução': 'Entwicklung',
                    'Consórcios': 'Konsortien',
                    'Recursos': 'Ressourcen',
                    'Sobre': 'Über uns',
                    'Contato': 'Kontakt'
                }
            };

            // Map of navigation links to their original Portuguese keys
            const linkMapping = {
                'historia.html': 'História',
                'evolucao.html': 'Evolução',
                'consorcios.html': 'Consórcios',
                'recursos.html': 'Recursos',
                'sobre.html': 'Sobre',
                'contato.html': 'Contato'
            };

            // Update navigation menu
            document.querySelectorAll('.site-nav .page-link').forEach(link => {
                const href = link.getAttribute('href');
                if (href) {
                    // Extract filename from href
                    const filename = href.split('/').pop();
                    const originalKey = linkMapping[filename];

                    if (originalKey && translations[lang] && translations[lang][originalKey]) {
                        link.textContent = translations[lang][originalKey];
                    }
                }
            });
        }

        // Apply saved language on page load
        if (currentLanguage !== 'pt') {
            translatePage(currentLanguage);
        }
    });
</script>